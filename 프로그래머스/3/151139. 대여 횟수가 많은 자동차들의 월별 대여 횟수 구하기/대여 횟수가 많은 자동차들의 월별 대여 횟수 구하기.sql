# SELECT DISTINCT CAR_ID
#   FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
#  WHERE CAR_ID NOT IN (SELECT CAR_ID FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY WHERE START_DATE >= '2022-08-01' AND START_DATE <= '2022-10-31' GROUP BY CAR_ID HAVING COUNT(*) >= 5)

SELECT
  CASE
    WHEN START_DATE >= '2022-08-01' AND START_DATE <= '2022-08-31' THEN 8
    WHEN START_DATE >= '2022-09-01' AND START_DATE <= '2022-09-30' THEN 9
    WHEN START_DATE >= '2022-10-01' AND START_DATE <= '2022-10-31' THEN 10
  END AS 'MONTH'
,CAR_ID, COUNT(CAR_ID) AS 'RECORDS'
 FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
WHERE CAR_ID IN (SELECT CAR_ID FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY WHERE START_DATE >= '2022-08-01' AND START_DATE <= '2022-10-31' GROUP BY CAR_ID HAVING COUNT(*) >= 5)
  AND START_DATE >= '2022-08-01' AND START_DATE <= '2022-10-31'
GROUP BY MONTH, CAR_ID
ORDER BY MONTH, CAR_ID DESC
